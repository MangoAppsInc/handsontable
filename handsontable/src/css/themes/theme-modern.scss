@import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');

/* theme vars */
$frozen-size: 2px;

/* overwrites vars */
.handsontable.theme-modern,
.theme-modern .handsontable {

    /* Base Colors */
    --hot-foreground-color: #222222;
    --hot-foreground-color-active: #B5B5B9;
    --hot-read-only-text: #999999;
    --hot-placeholder-text: #999999;
    --hot-background-color: #ffffff;
    --hot-border-color: #D1D1D5;
    --hot-separator-color: #EFEFF3;
    --hot-accent-color: #1A42E8;
    --hot-frozen-shadow: rgba(0, 0, 0, 0.2);

    /* Sizing */
    --hot-border-horizontal-size: 1px;
    --hot-border-vertical-size: 1px;
    --hot-base-padding: 4px;

    /* Cell */
    --hot-cell-height: 20px;
    --hot-cell-line-height: 20px;
    --hot-cell-horizontal-padding: 8px;
    --hot-cell-vertical-padding: 4px;

    /* Font */
    --hot-font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Helvetica Neue", Arial, sans-serif;
    --hot-base-font-size: 14px;

    /* Input Fields */
    --hot-input-border-color: #5292F7; //htInput

    --hot-link-accent-color: var(--hot-accent-color);
    --hot-link-color: var(--hot-link-accent-color);
    --hot-mobile-focus-color: var(--hot-input-border-color);
    --hot-area-color: var(--hot-accent-color);
    --hot-column-resizer-color: var(--hot-accent-color);
    --hot-column-resizer-guide-color: #777777;
    --hot-editor-text-color: var(--hot-foreground-color-active);
    --hot-editor-background-color: var(--hot-background-color);
    
    /* Search */
    --hot-search-highlight-color: #583707;
    --hot-search-highlight-background-color: #fcedd9;
    --hot-invalid-background-color: #ffbeba;

    /* Header */
    --hot-header-background-color: #F7F7F9;
    --hot-header-foreground-color: #5D5D5D;
    --hot-header-active-background-color: #EFEFF3;
    --hot-header-active-text-color: var(--hot-foreground-color-active);
    --hot-header-highlight-background-color: #EFEFF3; 
    --hot-header-highlight-active-background-color: #353535; 
    --hot-header-current-color: var(--hot-accent-color);
    --hot-header-horizontal-padding: var(--hot-cell-horizontal-padding);
    --hot-header-vertical-padding: var(--hot-cell-vertical-padding);
    --hot-header-line-height: var(--hot-cell-line-height);

    --hot-resizer-width: 5px;

    /* Listbox */
    --hot-lsitbox-border-color: var(--hot-border-color);
    --hot-lsitbox-background-color: var(--hot-background-color);
    --hot-lsitbox-background-current-color: #F7F7F9;
    --hot-lsitbox-border-size: 1px;

    /* Dropdown */
    --hot-dropdown-button-background: none;
    --hot-dropdown-button-color:#bbbbbb;
    --hot-dropdown-button-hover-color: #777777;
    --hot-dropdown-button-border-size: 0;
    --hot-dropdown-button-border-color: #bbbbbb;
    --hot-dropdown-button-radius: 4px;
    --hot-dropdown-button-padding: 8px;
    --hot-dropdown-button-margin: 8px;
    --hot-dropdown-button-background-active: none;
    --hot-dropdown-button-background-active-color: none;
    --hot-dropdown-button-border-active-color: none;
    --hot-dropdown-border-color: none;
    --hot-dropdown-border-width: 0px;

    --hot-dropdown-menu-background: var(--hot-background-color);
    --hot-dropdown-menu-item-padding: 8px;
    --hot-dropdown-menu-item-inner-padding: 8px; //left&right
    --hot-dropdown-menu-item-active:#F7F7F9;
    --hot-dropdown-separator-color: var(--hot-separator-color);
    --hot-dropdown-separator-size: 1px;

    /* Context Menu */
    --hot-contextmenu-border-color: var(--hot-dropdown-border-color);
    --hot-contextmenu-border-width: var(--hot-dropdown-border-width);
    --hot-contextmenu-background-color: var(--hot-dropdown-menu-background);
    --hot-contextmenu-item-padding: var(--hot-dropdown-menu-item-padding);
    --hot-contextmenu-item-inner-padding: 10px 6px; //left&right
    --hot-contextmenu-item-current-background-color:f3f3f3;
    --hot-contextmenu-separator-color: var(--hot-dropdown-separator-color);
    --hot-contextmenu-separator-size: var(--hot-dropdown-separator-size);

    /* Filters */
    --hot-filters-menu-background: var(--hot-dropdown-menu-background);
    --hot-filters-border-color: var(--hot-dropdown-button-border-color);
    --hot-filters-border-width: var(--hot-dropdown-border-width);
    --hot-filters-menu-item-active: var(--hot-dropdown-menu-item-active);
    --hot-filters-separator-color: var(--hot-dropdown-separator-color);
    --hot-filters-separator-size: var(--hot-dropdown-separator-size);
    --hot-filters-menu-item-inner-padding: var(--hot-dropdown-menu-item-inner-padding); //left&right

    --hot-filters-menu-filtering-border-width: 1px;
    --hot-filters-menu-filtering-border-color: var(--hot-border-color);
    --hot-filters-menu-filtering-border-style: solid;
    --hot-filters-menu-filtering-height: 160px;

    --hot-filters-menu-label-font-size: 12px;
    --hot-filters-menu-label-line-height: 20px;
    --hot-filters-menu-label-padding: 8px 0 2px;
    --hot-filters-menu-action-bar-padding: 8px 0 0;
    --hot-filters-menu-action-bar-align: center;
    --hot-filters-menu-conditional-input-padding: 0 0 5px 0;
    --hot-filters-menu-conditional-border-width: 1px;
    --hot-filters-menu-conditional-border-color: var(--hot-border-color);
    --hot-filters-menu-conditional-border-style: solid;
    --hot-filters-menu-value-border-width: var(--hot-filters-menu-conditional-border-width);
    --hot-filters-menu-value-border-color: var(--hot-separator-color);
    --hot-filters-menu-value-border-style: var(--hot-filters-menu-conditional-border-style);
    --hot-filters-menu-value-search-padding: 0;
    --hot-filters-menu-input-font-size: var(--hot-button-font-size);
    --hot-filters-menu-input-padding: 6px 12px;
    --hot-filters-menu-operators-padding: 4px;
    
    /* Comments */
    --hot-comment-indicator-size: 6px;
    --hot-comment-indicator-color: var(--hot-foreground-color-active);
    --hot-comment-textarea-background-color: var(--hot-background-color);
    --hot-comment-textarea-shadow: rgba(0, 0, 0, 0.117647) 0 1px 3px, rgba(0, 0, 0, 0.239216) 0 1px 2px;
    --hot-comment-textarea-border-color: var(--hot-border-color);
    --hot-comment-textarea-border-size: 3px;
    --hot-comment-textarea-padding: 5px;
    --hot-comment-textarea-height: 90px;
    --hot-comment-textarea-width: 215px;
    --hot-comment-textarea-font-size: calc(var(--hot-base-font-size) - 1px);
    --hot-comment-textarea-font-family: monospace;
    --hot-comment-textarea-focus-color: var(--hot-input-border-color);
    --hot-comment-textarea-focus-shadow: rgba(0, 0, 0, 0.117647) 0 1px 3px, rgba(0, 0, 0, 0.239216) 0 1px 2px, inset 0 0 0 1px var(--hot-input-border-color);

    /* Input */
    --hot-form-input-wrapper-padding: 3px 0 7px 0;
    --hot-form-input-radius: 4px;
    --hot-form-input-border-color: #d2d1d1;
    --hot-form-input-border-size: 1px;

    /* Button */
    --hot-button-background-color: #eeeeee;
    --hot-button-text-color: var(--hot-foreground-color-active);
    --hot-button-font-size: 12px;
    --hot-button-font-weight: bold;
    --hot-button-height: 19px;
    --hot-button-width: 64px;
    --hot-button-radius: var(--hot-input-radius);
    --hot-button-border-color: var(--hot-input-border-color);
    --hot-button-border-size: var(--hot-input-border-size);
    --hot-button-hover-border-color: #b9b9b9;
    --hot-button-hover-background-color: var(--hot-button-background-color);
    --hot-button-hover-text-color: var(--hot-button-text-color);
    --hot-button-margin: 10px;

    --hot-button-primary-border-color: #0f9d58;
    --hot-button-primary-background-color: #18804e;
    --hot-button-primary-text-color: #fff;
    --hot-button-primary-hover-border-color: #1a6f46;
    --hot-button-primary-hover-background-color: var(--hot-button-primary-background-color);
    --hot-button-primary-hover-text-color: var(--hot-button-primary-text-color);
    --hot-button-primary-focus-border-color: #7cb878;
    --hot-button-primary-focus-background-color: #92dd8d;
    --hot-button-primary-focus-text-color: #000;

    /* Select */
    --hot-select-wrapper-margin: 2px 0 0;
    --hot-select-background-color: #fff;
    --hot-select-radius: var(--hot-form-input-radius);
    --hot-select-border-color: var(--hot-form-input-border-color);
    --hot-select-border-size: var(--hot-form-input-border-size);
    --hot-select-font-size: var(--hot-button-font-size);
    --hot-select-padding: 6px 20px 6px 12px;
    --hot-select-font-weight: normal;
    --hot-select-hover-border-color: var(--hot-button-hover-border-color);
    --hot-select-hover-background-color: var(--hot-select-background-color);
    --hot-select-hover-text-color: var(--hot-button-text-color);
    --hot-select-text-color: var(--hot-foreground-color);
    
    /* Radio */
    --hot-radio-wrapper-margin: 8px;
    --hot-radio-margin: 0.5ex;

    /* Checkbox */
    --hot-checkbox-margin-top: 0;
    --hot-checkbox-margin-bottom: 0;
    --hot-checkbox-margin-bottom-start: 0;
    --hot-checkbox-margin-bottom-end: 8px;
    --hot-checkbox-height: 16px;

    /* Hidden Dimensions */
    --hot-hidden-dimension-indicator-margin-column: 1px;
    --hot-hidden-dimension-indicator-margin-row: 2px;
    --hot-hidden-dimension-indicator-color: #bbbbbb;
    --hot-hidden-dimension-indicator-color-highlighted: #eeeeee;
    
    /* Manual Move */
    --hot-manualMove-color: 53, 53, 53;
    --hot-manualMove-guideline-color: rgb(var(--hot-manualMove-color));
    --hot-manualMove-guideline-size: 1px;
    --hot-manualMove-backlight-color: rgba(var(--hot-manualMove-color), .1);

    /* Nested Rows */
    --hot-nestedrows-start: 7px;
    --hot-nestedrows-levels-padding: 11px;

    /* Renderer Autocomplete Arrow */
    --hot-AutocompleteArrow-color: #bbbbbb;
    --hot-AutocompleteArrow-hover-color: #777;
    --hot-AutocompleteArrow-invalid-color: #555555;
    --hot-AutocompleteArrow-invalid-hover-color: #1a1a1a;
    --hot-AutocompleteArrow-area-color: #d3d3d3;


    /* 
        Icons 
    */

    @mixin icon($name, $size: 16px, $color: null) {
        width: $size;
        height: $size;
        display: inline-block;
        content:'';
        background: {
            image: url('icons/#{$name}.svg');
            size: contain;
            repeat: no-repeat;
        }

        @if $color != null {
            // This part assumes the SVGs are simple icons and allows color overrides
            mask: url('icons/#{$name}.svg') no-repeat center;
            background-color: $color;
            -webkit-mask: url('icons/#{$name}.svg') no-repeat center;
        }
    }

    .htItemWrapper {
        &:before {
            vertical-align: text-bottom;
            margin-right: 12px;
        }
        span.selected {
            font-size: 0;
            inset:0;

            &:after {
                content: '';
                display: block;
                pointer-events: none;
                content: '';
                width: 6px;
                height: 10px;
                position: absolute;
                right: 16px;
                top: 50%;
                border-left: 2px solid var(--hot-accent-color);
                border-top: 2px solid var(--hot-accent-color);
                transform: translate(-50%, -50%) rotate(-135deg);
                box-sizing: border-box;
                transition: all .2s ease-in-out ;
            }

            &::before {
                content: '';
                display: bl;
                position: absolute;
                inset: 0;
                background-color: var(--hot-accent-color);
                opacity: .1;
            }
        }
    }

    [role="menuitem"] {
        &.htDisabled {
            .htItemWrapper:before { opacity: .4; }
        }

        &[aria-label="Alignment"]               .htItemWrapper:before { @include icon('icon-align-left', 16px, var(--hot-foreground-color)); }
        &[aria-label*="Read only"]               .htItemWrapper:before { @include icon('icon-eye', 16px, var(--hot-foreground-color)); }
        &[aria-label="Clear column"]            .htItemWrapper:before { @include icon('icon-x', 16px, var(--hot-foreground-color)); }
        &[aria-label="Remove column"]           .htItemWrapper:before,
        &[aria-label="Remove columns"]          .htItemWrapper:before { @include icon('icon-column-remove', 16px, var(--hot-foreground-color)); }
        &[aria-label="Remove row"]             .htItemWrapper:before,
        &[aria-label="Remove rows"]             .htItemWrapper:before { @include icon('icon-row-remove', 16px, var(--hot-foreground-color)); }
        &[aria-label="Insert column right"]     .htItemWrapper:before { @include icon('icon-column-insert-right', 16px, var(--hot-foreground-color)); }
        &[aria-label="Insert column left"]      .htItemWrapper:before { @include icon('icon-column-insert-left', 16px, var(--hot-foreground-color)); }
        &[aria-label="Insert row above"]        .htItemWrapper:before { @include icon('icon-row-insert-top', 16px, var(--hot-foreground-color)); }
        &[aria-label="Insert row below"]        .htItemWrapper:before { @include icon('icon-row-insert-bottom', 16px, var(--hot-foreground-color)); }
        &[aria-label="Undo"]                    .htItemWrapper:before { @include icon('icon-arrow-back-up', 16px, var(--hot-foreground-color)); }
        &[aria-label="Redo"]                    .htItemWrapper:before { @include icon('icon-arrow-forward-up', 16px, var(--hot-foreground-color)); }
        &[aria-label="Copy"]                    .htItemWrapper:before { @include icon('icon-copy', 16px, var(--hot-foreground-color)); }
        &[aria-label="Cut"]                     .htItemWrapper:before { @include icon('icon-scissors', 16px, var(--hot-foreground-color)); }
        &[aria-label="Insert child row"]        .htItemWrapper:before { @include icon('icon-inset-child', 16px, var(--hot-foreground-color)); }
        &[aria-label="Detach from parent"]      .htItemWrapper:before { @include icon('icon-detach-child', 16px, var(--hot-foreground-color)); }
        &[aria-label="Hide column"]             .htItemWrapper:before, 
        &[aria-label="Hide columns"]            .htItemWrapper:before { @include icon('icon-eye-off', 16px, var(--hot-foreground-color)); }
        &[aria-label="Merge cells"]             .htItemWrapper:before { @include icon('icon-marge-cell', 16px, var(--hot-foreground-color)); }

        // Align Horizontal
        &[aria-label*="Center"]                  .htItemWrapper:before { @include icon('icon-align-center', 16px, var(--hot-foreground-color)); }
        &[aria-label*="Left"]                    .htItemWrapper:before { @include icon('icon-align-left', 16px, var(--hot-foreground-color)); }
        &[aria-label*="Right"]                   .htItemWrapper:before { @include icon('icon-align-right', 16px, var(--hot-foreground-color)); }
        &[aria-label*="Justify"]                 .htItemWrapper:before { @include icon('icon-align-justified', 16px, var(--hot-foreground-color)); }

        // Align Vertical
        &[aria-label*="Top"]                     .htItemWrapper:before { @include icon('icon-arrow-bar-to-up', 16px, var(--hot-foreground-color)); }
        &[aria-label*="Middle"]                  .htItemWrapper:before { @include icon('icon-arrow-bar-both', 16px, var(--hot-foreground-color)); }
        &[aria-label*="Bottom"]                  .htItemWrapper:before { @include icon('icon-arrow-bar-to-down', 16px, var(--hot-foreground-color)); }

        // Comments
        &[aria-label="Add comment"]             .htItemWrapper:before { @include icon('icon-message-plus', 16px, var(--hot-foreground-color)); }
        &[aria-label="Delete comment"]          .htItemWrapper:before { @include icon('icon-message-x', 16px, var(--hot-foreground-color)); }
        &[aria-label="Read-only comment"]       .htItemWrapper:before { @include icon('icon-message-cancel', 16px, var(--hot-foreground-color)); }
    }

    /*
        Custom Syles 
    */
    @keyframes marching-ants {
        0% {
            background-position: 0 0, 8px 100%, 0 8px, 100% 0;
        }
        100% {
            background-position: 8px 0, 0 100%, 0 0, 100% 8px;
        }
    }

    scrollbar-width: thin;
    scrollbar-color: var(--hot-border-color) var(--hot-header-background-color);

    
    thead th { 
        height: var(--hot-cell-height) !important;
    }

    .changeType {
        height: 16px; 
        width: 16px;
        display: inline-block;
        margin: 2px;
        margin-inline-end: calc(2px - var(--hot-header-vertical-padding));
        position: relative;
        border-radius: 4px;
        z-index: 1;

        &:before {
            content: "";
            display: block;
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 4px 3px 0 3px;
            border-color: transparent;
            border-top-color: var(--hot-read-only-text);
            position: absolute;
            left: 5px;
            top: 6px;
        }

        &:hover { 
            background-color: var(--hot-border-color);
            &:before {
                border-top-color: white;
            }
        }
    }

    thead th .relative {
        height: inherit;
    }
    
    .columnSorting.sortAction {
        display: inline-flex;
        align-items: center;
        gap: 0;
        //position: absolute;
        inset: 0;
        //padding: var(--hot-header-vertical-padding) var(--hot-header-horizontal-padding);

        &:hover { 
            //background: rgba(0,0,0,.04);
            text-decoration: none;
        }

        &:before { 
            position: static;
            order: 1;
            //display: none;
            width: 16px;
            height: 16px;
            margin: 0; 
            padding: 0;
        }

        &.descending:before {
            display: inline-block; 
            @include icon('icon-arrow-narrow-down', 16px, var(--hot-foreground-color));
        }
        &.ascending:before { 
            display: inline-block;
            @include icon('icon-arrow-narrow-up', 16px, var(--hot-foreground-color));
        }

        &:after {
            position: static;
            order: 2;
            margin-left: -5px;
            padding-inline-start: 0;
        }
    }

    .changeType + .columnSorting.sortAction {
        //padding-right: calc(var(--hot-header-horizontal-padding) + 16px )
    }

    th.ht__active_highlight { 
        .columnSorting.sortAction {
            &:hover { 
                //background: rgba(255,255,255,.08);
            }

            &:before {
                filter: invert(1);
                opacity: .6;
            }
        }
    }

    th { 
        //height: auto !important;
        box-sizing: border-box;
    }

    tbody th.current, 
    thead th.current {
        box-shadow:     inset 0 0 0 calc(var(--hot-border-horizontal-size) * 1) var(--hot-header-current-color);
    }

    tbody th.ht__active_highlight, 
    thead th.ht__active_highlight {
        border-color: var(--hot-foreground-color);
        box-shadow: calc(var(--hot-border-vertical-size) * -1) calc(var(--hot-border-horizontal-size) * -1) 0  var(--hot-foreground-color), 
                    0 calc(var(--hot-border-horizontal-size) * -1) 0  var(--hot-foreground-color), 
                    calc(var(--hot-border-vertical-size) * -1) 0 0 var(--hot-foreground-color);

        &:before {
            background: var(--hot-accent-color)
        }
    }

    /* thin border highlight */
    tbody th, thead th {
        position: relative;
        overflow: visible;

        &.ht__highlight {                 
            &:before { 
                content:'';
                display: block;;
                position: absolute;
                left: -1px;
                bottom: -1px;
                right: -1px;
                height: 1px;
                background-color: var(--hot-accent-color);
            }
        }
    }

    tbody th.ht__highlight:before {
        width: 1px;
        height: auto;
        right: -1px;
        top: -1px;
        bottom: -1px;
        left: auto;
    }

    .ht__manualColumnMove--backlight {
        //opacity: .1;
    }

    .wtBorder{
        &.area {
            background-color: var(--hot-accent-color) !important;
        }
        &.fill {
            background-image: 
            linear-gradient(90deg, white 50%, transparent 50%), 
            linear-gradient(90deg, white 50%, transparent 50%), 
            linear-gradient(0, white 50%, transparent 50%), 
            linear-gradient(0, white 50%, transparent 50%);
            background-repeat: repeat-x, repeat-x, repeat-y, repeat-y;
            background-size: 8px 2px,0px 0px,2px 8px,0px 0px;
            animation: marching-ants 600ms infinite linear;
            background-color: var(--hot-accent-color) !important;
        }
        &.current {
            background-color: var(--hot-accent-color) !important;
        }
    }

    /* collaosible indicator */
    .collapsibleIndicator, 
    .ht_nestingButton {
        transform: translate(0%, -50%);
        position: absolute;
        top: 50%;
        left: unset;
        right: 4px;
        overflow: hidden;
        text-indent: -100px;
        cursor:pointer;
        border-radius: 2px; ;
        width: 14px;
        height: 14px;
        border: 1px solid var(--hot-border-color);
        background-color: var(--hot-background-color);
        box-shadow: none;
    
        &:after, 
        &:before { 
            content: '';
            display: block;
            transform: translate(-50%, -50%);
            position: absolute; 
            width: 10px; 
            height: 2px; 
            top:50%; 
            left: 50%; 
            background-color: var(--hot-border-color);
        }
        &:before { 
            height: 10px; 
            width: 2px; 
            display: none;
        }
    
        &.expanded { 
            &:hover { 
                &:after { 
                    background-color: var(--hot-accent-color);
                }
            }
        }
        &.collapsed,
        &.ht_nestingExpand { 
            background-color: var(--hot-header-active-background-color);
            border-color: var(--hot-border-color);

            &:before, &:after { 
                display: block;
                background-color: var(--hot-border-color);
            }
    
            &:hover { 
                &:before, &:after { 
                    background-color: var(--hot-accent-color);
                }
                background-color: var(--hot-header-active-background-color);
                //border-color: var(--hot-accent-color);
            }
        }   
    }

    .ht_nestingButton { 
        position: relative;
        order: -1;
        transform: none;
        top: 0;
        margin-right: 4px;
    }

    .ht_nestingLevels { 
        // overflow: hidden !important;

        > .relative {
            display: flex;
            align-items: center;
            justify-content: center;
        }
    }

    .ht_nestingLevel_empty {
        border-bottom: 1px solid var(--hot-border-color);
        height: calc(var(--hot-cell-line-height) / 2 );
        position: relative;
        width: 8px;
        align-self: start;

        &:first-child { 
            margin-left: -2px;
            width: 4px;

            &:before { 
                content: '';
                display: block;
                border-left: 1px solid var(--hot-border-color);
                height: calc(var(--hot-cell-line-height) * .5 + 3px);
                position: absolute;
                bottom: 0;
                left: 0;
            }
        }
        + .rowHeader {
            margin-left: 6px;
        }

        + .ht_nestingLevel_empty {
            border-left: 0;
            border-bottom: 1px solid var(--hot-border-color);
        }
    }
    
    .ht__active_highlight {
        .ht_nestingLevel_empty {
            border-color:#666;

            &:before { 
                border-color:#666;
            }
        }

        .collapsibleIndicator,
        .ht_nestingButton {
            border: 1px solid #000000;
            background-color: #171717;

            &:hover { 
                background-color: #373737;
                &:before,
                &:after {
                    background-color: #ffffff;
                }
            }

            &:before,
            &:after { } 
            &.expanded { }
            &.collapsed { }
        }

        .changeType {
            &:hover {
                background-color: #000000;
            }
        }
    } 
    

    [dir=rtl].handsontable .collapsibleIndicator {
        right: unset;
        left: 4px;
    }

    /* Frozen border */
    // Start 
    .ht_clone_inline_start.ht_clone_left,
    .ht_clone_bottom_left_corner,
    .ht_clone_top_left_corner {
        tbody tr td:last-child,
        thead tr th:not(:first-child):last-child  {    
            box-shadow: ($frozen-size * -1) 0 0 0 inset var(--hot-frozen-shadow);
            
            &.current {
                box-shadow: ($frozen-size * -1) 0 0 0 inset var(--hot-frozen-shadow), 0 0 0 1px inset var(--hot-accent-color);
            }
        }

        tbody tr td.ht__highlight:last-child,
        thead tr th.ht__active_highlight:not(:first-child):last-child  {    
            box-shadow: ($frozen-size * -1) 0 0 0 inset var(--hot-header-highlight-active-background-color) ; 
        }
        
    }
    // Start + Top
    .ht_clone_top_left_corner {
        tbody tr:last-child td:last-child {
            box-shadow: ($frozen-size * -1) ($frozen-size * -1) 0 0 inset var(--hot-frozen-shadow); 
        }
    }

    // Bottom 
    .ht_clone_bottom,
    .ht_clone_bottom_left_corner {
        tbody tr:first-child { 
            td, th {
                box-shadow: 0 $frozen-size 0 0 inset var(--hot-frozen-shadow) ; 
            }
        }
    } 
    .ht_clone_bottom_left_corner {
        tbody tr:first-child td:last-child {
            box-shadow: ($frozen-size * -1) $frozen-size 0 0 inset var(--hot-frozen-shadow); 
        }
    }

    // Top
    .ht_clone_top,
    .ht_clone_top_left_corner {
        tbody tr:last-child { 
            td, th  {
                box-shadow: 0 ($frozen-size * -1) 0 0 inset var(--hot-frozen-shadow);
                
                &.current {
                    box-shadow: 0 ($frozen-size * -1) 0 0 inset var(--hot-frozen-shadow), 0 0 0 1px inset var(--hot-accent-color);
                }
            }
        }
    }

    /* htAutocompleteArrow */
    .handsontable {
        .htAutocompleteArrow { 
            width: 16px; 
            height: 16px; 
            font-size: 0;
            position: relative;
            top: 50%;
            transform: translateY(-50%);

            &:after {
                width: 4px;
                height: 4px;
                content:'';
                display: block;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: rotate(45deg) translate(-100%);
                border-right: 1px solid var(--hot-read-only-text);
                border-bottom: 1px solid var(--hot-read-only-text)
            }
        }
    }

    /* dropdown */
    &.htDropdownMenu table.htCore {
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.12);
        padding: 8px 0;
    }
    &.htDropdownMenu  .htCustomMenuRenderer .table.htCore {
        box-shadow: none;
    }

    .htSeparator { 
        margin: 8px 0;
    }

    /* contextMenu */
    &.htContextMenu .htCore { 
        box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.12);
        padding: 8px 0;
        border-radius: 8px;
        margin-bottom: 16px;

        tbody tr td {
            position: relative;

            &.current {
                background: var(--hot-header-background-color);
            }

            .htSeparator {
                height: auto !important;
                border: none;
                padding: 4px 0;
                margin: 0;

                .htItemWrapper { 
                    border-top: var(--hot-contextmenu-separator-size) solid var(--hot-contextmenu-separator-color); 
                    margin: 0;
                }
            }
        }
    }

    /* dropdownMenu */
    &.htDropdownMenu table.htCore {
        tbody tr td {
            position: relative;
        }
    }

    /* select */
    .htSelectEditor  {
        -webkit-appearance: none !important;
        border-color: var(--hot-accent-color);
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTAuNDY0NTc3IDIuNTM1MTZMNC4wMDAxMSA2LjA3MDY5TDcuNTM1NjQgMi41MzUxNkw2LjgyODU0IDEuODI4MDVMNC4wMDAxMSA0LjY1NjQ4TDEuMTcxNjggMS44MjgwNUwwLjQ2NDU3NyAyLjUzNTE2WiIgZmlsbD0iIzc3Nzc3NyIvPgo8L3N2Zz4K");
        background-repeat: no-repeat;
        background-size: 36px 8px;
        background-position: right center;
        background-clip: border-box;
        padding-right: 26px;        
    }

    /* listbox */
    .listbox {
        .ht_master {
            overflow: visible;

            .wtHolder {
                overflow: visible;
            }
        }

        table {
            border:0;
            box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.12);
            border-radius: 8px;
            overflow: hidden;

            thead th { height: auto !important;
                text-align: left;
                
                > div { 
                    padding-top: 8px; 
                    padding-bottom: 8px; 
                }

                &:first-child {
                    padding-left: 8px;
                }
            }
            tbody td {
                &:first-child {
                    padding-left: 16px;
                }
                &:last-child {
                    padding-right: 16px;
                }
            }
        }

        .ht_clone_top { 
            .wtHider {
                overflow: hidden;
            }

            table { 
                border-radius: 0;
            }
        }
    }

    /* submenu */
    .htSubmenu :after {
        width: 4px;
        height: 4px;
        content:'';
        display: block;
        position: absolute;
        top: 50%;
        right: 16px;
        transform: rotate(45deg) translate(-100%);
        border-right: 1px solid var(--hot-read-only-text);
        border-top: 1px solid var(--hot-read-only-text)
    }

    /* checkbox */
    .htCheckboxRendererLabel {
        display: flex;
        align-items: center;
        gap: 4px;
        position: relative;

        &:has(input:checked)::before {
            background-color: var(--hot-accent-color);
            border-color: var(--hot-accent-color);
        }

        input { 
            position: absolute; 
            opacity: 0; 
            inset: 0;
            visibility: hidden;
        }
        &::before {
            pointer-events: none;
            content: '';
            border: 2px solid var(--hot-border-color);
            border-radius: 2px;
            width: var(--hot-checkbox-height);
            height: var(--hot-checkbox-height);
            display: inline-block;
            box-sizing: border-box;
            background-color: var(--hot-background-color);
            transition: all .5s ease-in-out ;
        }
        &::after { 
            pointer-events: none;
            content: '';
            width: 6px;
            height: 10px;
            position: absolute;
            left: calc(var(--hot-checkbox-height) * .5);
            top: calc(var(--hot-checkbox-height) * .5);
            border-left: 2px solid var(--hot-background-color);
            border-top: 2px solid var(--hot-background-color);
            transform: translate(-50%, -50%) rotate(-135deg);
            box-sizing: border-box;
            transition: all .2s ease-in-out ;
        }
    }   

    /* comment */
    .htCommentCell:after {
        border-top-color: var(--hot-accent-color);
    }

    /* manualColumnResizer */
    .manualColumnResizer {
        width: 10px;
        background: none;
        margin: 0;
        opacity: 0;
        transition: opacity .2s ease-in-out ;

        &::before, &::after {
            content: '';
            height: calc(100% - 8px);
            width: 2px;
            display: block;
            background: var(--hot-read-only-text);
            border-radius: 2px;
            margin: 4px 0;
            top:0;
            left:1px;
            position: absolute;
        }
        &:after {
            right: 0;
            left: auto
        }

        &:hover, 
        &.active {
            opacity: 1;
        }
    }

    .manualRowResizer {
        height: 10px;
        background: none;
        margin: 0;
        opacity: 0;
        transition: opacity .2s ease-in-out ;

        &::before, &::after {
            content: '';
            width: calc(100% - 8px);
            height: 2px;
            display: block;
            background: var(--hot-read-only-text);
            border-radius: 2px;
            margin: 0 4px;
            top:1px;
            left:0;
            position: absolute;
        }
        &:after {
            bottom: 0;
            top: auto
        }

        &:hover, 
        &.active {
            opacity: 1;
        }
    }

    .manualColumnResizerGuide,
    .manualRowResizerGuide {
        border-style: solid;
    }

    .manualColumnResizerGuide {
        border-left: 0;
    }
    .manualRowResizerGuide {
        border-top: 0;
    }
}

.theme-modern .htCommentsContainer .htCommentTextArea {
    border:0;
    border-inline-start: 2px solid #1A42E8;
    box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.12);
    border-radius: 0 8px 8px 0;
    margin: 0 -1px;
    padding: 12px;
    font-family: 'Inter';
    font-size: 14px;
    line-height: 22px;
}
