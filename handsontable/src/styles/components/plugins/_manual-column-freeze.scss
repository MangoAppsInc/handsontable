// Handsontable Column Freeze

@mixin output {
  .handsontable {
    .htRowHeaders .ht_master.innerBorderInlineStart ~ .ht_clone {
      &_top_inline_start_corner th:nth-child(2),
      &_inline_start td:first-of-type {
        border-left: 0 none;
      }
    }
  }

  // Frozen border
  // Start + Top
  .ht_clone_top_left_corner {
    tbody tr:last-child td:last-child {
      box-shadow: calc((var(--ht-frozen-shadow-size) - 1px) * -1)
        calc((var(--ht-frozen-shadow-size) - 1px) * -1) 0 0 inset
        var(--ht-frozen-shadow-color);
    }
  }

  // Top
  .ht_clone_top,
  .ht_clone_top_left_corner {
    .htCore {
      background-color: var(--ht-background-color, #ffffff);
    }

    tbody tr:last-child {
      td,
      th {
        box-shadow: 0 calc((var(--ht-frozen-shadow-size) - 1px) * -1) 0 0 inset
          var(--ht-frozen-shadow-color);

        &.current {
          box-shadow: inset 0 0 0 1px var(--ht-cell-selection-border-color);
        }
      }
    }
  }

  // Start
  .ht_clone_inline_start.ht_clone_left,
  .ht_clone_bottom_left_corner,
  .ht_clone_top_left_corner {
    .htCore {
      background-color: var(--ht-background-color, #ffffff);
    }

    tbody tr td:last-child,
    thead tr th:not(:first-child):last-child {
      box-shadow: calc(-1 * (var(--ht-frozen-shadow-size) - 1px)) 0 0 0 inset
        var(--ht-frozen-shadow-color);

      &.current {
        box-shadow: inset 0 0 0 1px var(--ht-cell-selection-border-color);
      }

      &.ht__active_highlight {
        box-shadow: calc(-1 * (var(--ht-frozen-shadow-size) - 1px)) 0 0 0 inset
          var(--ht-header-active-border-color);
      }
    }
  }

  // Bottom
  .ht_clone_bottom,
  .ht_clone_bottom_left_corner {
    background-color: var(--ht-background-color, #ffffff);

    tbody tr:first-child {
      td,
      th {
        box-shadow: 0 calc(var(--ht-frozen-shadow-size) - 1px) 0 0 inset
          var(--ht-frozen-shadow-color);

        &.current {
          box-shadow: inset 0 0 0 1px var(--ht-cell-selection-border-color);
        }

        &.ht__active_highlight {
          box-shadow: calc(-1 * (var(--ht-frozen-shadow-size) - 1px)) 0 0 0 inset
            var(--ht-header-active-border-color);
        }
      }
    }
  }

  .ht_clone_bottom_left_corner {
    tbody tr {
      td:last-child,
      th:last-child {
        box-shadow: 0 calc(var(--ht-frozen-shadow-size) - 1px) 0 0 inset
            var(--ht-frozen-shadow-color),
          calc(-1 * (var(--ht-frozen-shadow-size) - 1px)) 0 0 0 inset
            var(--ht-frozen-shadow-color);

        &.current {
          box-shadow: inset 0 0 0 1px var(--ht-cell-selection-border-color);
        }

        &.ht__active_highlight {
          box-shadow: calc(-1 * (var(--ht-frozen-shadow-size) - 1px)) 0 0 0 inset
            var(--ht-header-active-border-color);
        }
      }
    }
  }

  // One Cell
  .ht_clone_top_inline_start_corner {
    thead {
      tr th:first-child {
        border-bottom-color: transparent;
      }
    }
  }
}
