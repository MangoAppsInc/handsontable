/*
  Handsontable Column Freeze
*/

@mixin output {
  .handsontable {
    .htRowHeaders .ht_master.innerBorderInlineStart ~ .ht_clone {
      &_top_inline_start_corner th:nth-child(2),
      &_inline_start td:first-of-type {
        border-left: 0 none;
      }
    }
  }

  /* Frozen border */
  // Start
  .ht_clone_inline_start.ht_clone_left,
  .ht_clone_bottom_left_corner,
  .ht_clone_top_left_corner {
    tbody tr td:last-child,
    thead tr th:not(:first-child):last-child {
      box-shadow: calc(-1 * var(--hot-frozen-size)) 0 0 0 inset
        var(--hot-frozen-shadow);

      &.current {
        box-shadow: calc(var(--hot-frozen-size) * -1) 0 0 0 inset
            var(--hot-frozen-shadow),
          0 0 0 1px inset var(--hot-accent-color);
      }
    }

    tbody tr td.ht__highlight:last-child,
    thead tr th.ht__active_highlight:not(:first-child):last-child {
      box-shadow: calc(var(--hot-frozen-size) * -1) 0 0 0 inset
        var(--hot-header-highlight-active-background-color);
    }
  }
  // Start + Top
  .ht_clone_top_left_corner {
    tbody tr:last-child td:last-child {
      box-shadow: calc(var(--hot-frozen-size) * -1)
        calc(var(--hot-frozen-size) * -1) 0 0 inset var(--hot-frozen-shadow);
    }
  }

  // Bottom
  .ht_clone_bottom,
  .ht_clone_bottom_left_corner {
    tbody tr:first-child {
      td,
      th {
        box-shadow: 0 var(--hot-frozen-size) 0 0 inset var(--hot-frozen-shadow);

        &.current {
          box-shadow: 0 var(--hot-frozen-size) 0 0 inset
              var(--hot-frozen-shadow),
            0 0 0 1px inset var(--hot-accent-color);
        }
      }
    }
  }
  .ht_clone_bottom_left_corner {
    tbody tr:first-child td:last-child {
      box-shadow: calc(var(--hot-frozen-size) * -1) var(--hot-frozen-size) 0 0
        inset var(--hot-frozen-shadow);
    }
  }

  // Top
  .ht_clone_top,
  .ht_clone_top_left_corner {
    tbody tr:last-child {
      td,
      th {
        box-shadow: 0 calc(var(--hot-frozen-size) * -1) 0 0 inset
          var(--hot-frozen-shadow);

        &.current {
          box-shadow: calc(-1 * var(--hot-frozen-size)) 0 0 inset
              var(--hot-frozen-shadow),
            0 0 0 1px inset var(--hot-accent-color);
        }
      }
    }
  }

  // One Cell
  .ht_clone_top_inline_start_corner {
    thead {
      tr th:first-child {
        border-bottom: transparent;
      }
    }
  }
}
